# PDF検査データ抽出アプリ

検査報告書PDFから27項目のデータを自動抽出し、Excelファイルとして出力するWebアプリケーションです。

## 🌟 特徴

- 📄 **PDFファイルのアップロード**: ブラウザから簡単にPDFをアップロード
- 🔍 **27項目の自動データ抽出**: OCR技術による高精度なテキスト認識
- 🌤️ **天気データの日本語変換**: fine→晴、cloud→曇、rain→雨に自動変換
- 📊 **Excelファイルでの出力**: 構造化されたデータをExcel形式でダウンロード
- 💻 **ブラウザベース**: インストール不要でどこからでもアクセス可能

## 📋 抽出対象項目（27項目）

1. **ShipNo.** - 船舶番号
2. **Kind of Material** - 材料種類
3. **Place** - 場所
4. **Inspection Date** - 検査日（YYYY/MM/DD形式）
5. **Inspection Time** - 検査時間
6. **Weather_1** - 天気1（日本語変換）
7. **Weather_2** - 天気2（日本語変換）
8. **Dry bulb Temp** - 乾球温度
9. **Wet bulb Temp** - 湿球温度
10. **Relative Humidity** - 相対湿度
11. **Dew Point** - 露点
12. **Surface Temp** - 表面温度
13. **Judgement** - 判定
14. **Surface Cleanliness** - 表面清浄度
15. **Surface Profile** - 表面粗さ（µm単位付き）
16. **Water Soluble Salt** - 水溶性塩分
17. **Dust** - ダスト（ISO認識問題修正）
18. **Oil / Grease** - オイル/グリース
19. **contamination of abrasive** - 研磨剤汚染
20. **Manufacturer** - 製造者
21. **Product name** - 製品名
22. **ID number** - ID番号
23. **Batch No Base** - ベースバッチ番号
24. **Batch No Hard** - ハードバッチ番号
25. **Lower** - 下限値
26. **Upper** - 上限値
27. **Measured D.F.T** - 測定膜厚
28. **Curing** - 硬化

## 🚀 使用方法

### 1. PDFファイルのアップロード
- 「PDFファイルをアップロードしてください」ボタンをクリック
- 検査報告書のPDFファイルを選択
- ファイルサイズが表示されます

### 2. データ抽出の実行
- 「🚀 データ抽出開始」ボタンをクリック
- 処理進捗がリアルタイムで表示されます
- 完了までお待ちください

### 3. 結果の確認とダウンロード
- 抽出されたデータのプレビューを確認
- 統計情報（ページ数、項目数、データ総数）を確認
- 「📥 Excelファイルをダウンロード」ボタンでファイルを取得

## 🎯 データ処理の特徴

### 日付フォーマット
- 入力: `2025-03-07`
- 出力: `2025/03/07`

### 天気データの変換
- `fine` → `晴`
- `cloud` → `曇`
- `rain` → `雨`
- スラッシュ分離: `fine/cloud` → `晴/曇`

### 表面粗さの単位変換
- 入力: `30-75 um`
- 出力: `30-75 µm`

### ダスト規格の修正
- OCR誤認識: `1S08502-3`
- 自動修正: `ISO8502-3`

## 📊 技術仕様

- **フロントエンド**: Streamlit
- **OCRエンジン**: Tesseract OCR
- **PDF処理**: PyMuPDF (fitz), pdfplumber
- **データ処理**: pandas, numpy
- **画像処理**: Pillow (PIL)
- **Excel出力**: openpyxl
- **デプロイ**: Streamlit Cloud

## 🔧 システム要件

### Streamlit Cloud環境
- **OS**: Ubuntu 20.04
- **Python**: 3.11
- **Tesseract**: システムパッケージとして利用可能
- **メモリ**: 1GB
- **CPU**: 1コア

### 対応ファイル形式
- **入力**: PDF（画像ベース推奨）
- **出力**: Excel (.xlsx)

## ⚠️ 注意事項

- **PDFファイル**: 画像ベースのPDFファイルを想定しています
- **処理時間**: ページ数とファイルサイズによって異なります（通常1-3分）
- **ファイルサイズ**: 50MB以下のPDFファイルを推奨
- **精度**: OCR技術のため、手書き文字や不鮮明な画像は認識精度が低下する場合があります

## 🛠️ トラブルシューティング

### よくある問題

**Q: PDFがアップロードできない**
A: ファイルサイズが50MB以下か確認してください。また、PDFファイルが破損していないか確認してください。

**Q: データ抽出が失敗する**
A: PDFが画像ベースか確認してください。テキストベースのPDFの場合は、画像として保存し直してください。

**Q: 抽出精度が低い**
A: PDFの画像解像度を確認してください。高解像度のPDFほど認識精度が向上します。

**Q: アプリが動作しない**
A: ブラウザを再読み込みしてください。それでも解決しない場合は、管理者にお問い合わせください。

## 📈 今後の予定

- [ ] より多くのPDF形式への対応
- [ ] 抽出精度の向上
- [ ] バッチ処理機能の追加
- [ ] 多言語対応
- [ ] API化

## 📄 ライセンス

このプロジェクトはMITライセンスの下で公開されています。

## 📞 サポート

技術的な問題やご質問がございましたら、GitHubのIssuesページでお知らせください。

---

**PDF検査データ抽出アプリ** - 検査業務の効率化をサポートします 🚀
